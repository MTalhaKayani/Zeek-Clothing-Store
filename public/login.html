<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>ZEEK – Login</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"/>
  <style>
    :root{
      --ink:#171717; --gold:#d4a017; --gold-strong:#c1900f;
      --muted:#e5e5e5; --card:#fff; --paper:#f7f4ee;
    }
    *{box-sizing:border-box; margin:0; padding:0;}
    html,body{height:100%; font-family:'Roboto',sans-serif; background:var(--paper); color:var(--ink); overflow:hidden;}

    .bg-slider{ position:fixed; inset:0; z-index:0; filter:blur(8px) brightness(.95); opacity:.90; transform:scale(1.06); pointer-events:none; }
    .bg-slide{ position:absolute; inset:0; background-position:center; background-size:cover; will-change:opacity, transform; }
    .bg1{ background-image:url('/images/hero/hero1-leaves.png'); animation:fade1 6s linear infinite; }
    .bg2{ background-image:url('/images/hero/hero2-men.png');   animation:fade2 6s linear infinite; }
    @keyframes fade1{ 0%{opacity:1;transform:translateX(0)}40%{opacity:1;transform:translateX(-2%)}50%{opacity:0;transform:translateX(-4%)}90%{opacity:0;transform:translateX(2%)}100%{opacity:1;transform:translateX(0)} }
    @keyframes fade2{ 0%{opacity:0;transform:translateX(4%)}40%{opacity:0;transform:translateX(2%)}50%{opacity:1;transform:translateX(0)}90%{opacity:1;transform:translateX(-2%)}100%{opacity:0;transform:translateX(-4%)} }

    .wrap{ position:relative; z-index:1; height:100vh; display:flex; align-items:stretch; justify-content:center; }
    .dialog{ width:min(700px,65vw); height:100vh; display:flex; overflow:hidden; background:var(--card); border-right:1px solid #eaeaea; border-left:1px solid #eaeaea; }
    .photoPane{ position:relative; flex:0 0 52%; display:flex; align-items:stretch; justify-content:center; background:transparent; overflow:hidden; }
    .photo{ position:relative; z-index:1; width:100%; height:100%; object-fit:contain; background:#fff; border-right:1px solid var(--muted); }
    .formPane{ flex:1; background:#fff; height:100%; display:flex; align-items:center; justify-content:center; padding:22px; }
    .card{ width:100%; max-width:360px; }

    .brand-logo{ display:block; margin:0 auto 10px; height:100px; width:300px; object-fit:contain; filter: drop-shadow(0 1px 3px rgba(0,0,0,.12)); cursor:pointer; }
    .sub{ text-align:center; color:#555; font-size:.92rem; margin-bottom:16px; }

    label{ display:block; font-weight:700; font-size:.92rem; margin:10px 0 6px; }
    .input{ width:100%; padding:10px 12px; border:1px solid #d6d6d6; border-radius:12px; font-size:14px; transition:border-color .15s, box-shadow .15s; }
    .input:focus{ outline:0; border-color:var(--gold); box-shadow:0 0 0 2px rgba(212,160,23,.18); }

    .row-half{ display:flex; gap:10px; margin:8px 0 12px; }
    .forgot{ width:50%; min-width:120px; border:1px solid #e7e7e7; background:#f7f7f7; color:#333; border-radius:10px; padding:7px 9px; font-size:12px; cursor:pointer; }
    .forgot:hover{ background:#eee; }

    .btn{ width:100%; padding:11px; border:0; border-radius:12px; cursor:pointer; font-weight:800; font-size:14px; margin:6px 0; transition: transform .05s, background .15s, box-shadow .15s; }
    .btn:active{ transform:translateY(1px); }
    .btn-primary{ background:var(--gold); color:#fff; box-shadow:0 6px 14px rgba(212,160,23,.22); }
    .btn-primary:hover{ background:var(--gold-strong); }
    .btn-secondary{ background:#f4f4f4; color:#111; border:1px solid #e6e6e6; }
    .btn-secondary:hover{ background:#ededed; }

    .btn-compact { padding: 7px; }
    .footer-actions{ margin-top:8px; display:grid; gap:6px; }

    @media (max-width:980px){
      .dialog{ flex-direction:column; height:100vh; width:100vw; border-left:0; border-right:0; }
      .photoPane{ flex:0 0 auto; height:40vh; }
      .photo{ border-right:0; border-bottom:1px solid var(--muted); }
    }
  </style>
</head>
<body>

  <div class="bg-slider">
    <div class="bg-slide bg1"></div>
    <div class="bg-slide bg2"></div>
  </div>

  <div class="wrap">
    <div class="dialog">
      <div class="photoPane">
        <img src="/images/login/loginpage.png" alt="Zeek apparel visual" class="photo">
      </div>

      <div class="formPane">
        <div class="card">
          <a href="/" aria-label="Go to homepage">
            <img src="/images/logo/zeekname.png" alt="ZEEK Logo" class="brand-logo">
          </a>
          <p class="sub">Welcome back</p>

          <form id="loginForm" novalidate>
            <label for="email">Email</label>
            <input id="email" name="email" class="input" type="email" placeholder="Enter your email" autocomplete="email" required>

            <label for="password">Password</label>
            <input id="password" name="password" class="input" type="password" placeholder="Enter your password" autocomplete="current-password" required>

            <div class="row-half">
              <button type="button" class="forgot" id="forgotBtn">Forgot Password?</button>
            </div>

            <button type="submit" class="btn btn-primary btn-compact">Sign In</button>
          </form>

          <button class="btn btn-primary btn-compact" onclick="location.href='signup.html'">Sign Up</button>

          <div class="footer-actions">
            <button class="btn btn-primary btn-compact" onclick="location.href='/'">← Back to homepage</button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
(async function () {
  const form = document.getElementById('loginForm');
  if (!form) return;

  async function getCsrf() {
    const r = await fetch('/api/csrf-token', { credentials: 'include' });
    if (!r.ok) throw new Error('Failed to fetch CSRF');
    const j = await r.json();
    return j.csrfToken;
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;

    if (!email || !password) {
      alert('Please enter email and password.');
      return;
    }

    const submitBtn = form.querySelector('button[type="submit"]');
    if (submitBtn) { submitBtn.disabled = true; submitBtn.textContent = 'Signing in…'; }

    try {
      const csrf = await getCsrf();
      const res = await fetch('/api/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'X-CSRF-Token': csrf },
        credentials: 'include',
        body: JSON.stringify({ email, password })
      });

      const data = await res.json().catch(() => ({}));
      if (!res.ok) {
        alert(data.message || 'Login failed');
        return;
      }

      // success → go to secure dashboard
      window.location.href = '/dashboard';
    } catch (err) {
      console.error(err);
      alert('Network error while logging in.');
    } finally {
      if (submitBtn) { submitBtn.disabled = false; submitBtn.textContent = 'Sign In'; }
    }
  });

  document.getElementById('forgotBtn')?.addEventListener('click', function(){
    alert('Password reset link will be sent to your email/phone (stub).');
  });
})();
</script>
</body>
</html>
